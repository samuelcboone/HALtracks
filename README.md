# HALtracks
A repository for the HALtracks 2D and HALtracks 3D automated digital fission-track convoluted neural networks (CNNs) of Boone et al. (2025), "AI-based approach for constraining the thermal evolution of Earth’s upper crust through automated digital fission track analysis".

Reference:
Samuel C. Boone, Ling Chung, Noel Faux, Usha Nattala, Thomas Church, Chenghao Jiang, Malcolm McMillan, Sean Jones, David Liu, Han Jiang, Kris Ehinger, Tom Drummond, Barry Kohn, and Andrew Gleadow (in review). AI-based approach for constraining the thermal evolution of Earth’s upper crust through automated digital fission track analysis.


About:

Here, we present two new open access AI-algorithms capable of automatically identifying and counting fission tracks in apatite and mica — one which works on pairs of reflected and transmitted light images of grain surfaces which we call HALtracks 2D, and one which uses reflected light images coupled with a z-stack of transmitted lights images at 0.5 μm intervals called HALtracks 3D. 

The HALtracks 2D and HALtracks 3D CNN architectures are based on the U-NET architecture proposed by Ronneberger et al. (2015), widely used in medical image analysis. The U-NET consists of two main parts: an encoder and decoder. The encoder is a contracting path involving a series of convolutional and pooling layers that progressively reduce the spatial dimensions of the input while capturing essential context and features. The decoder is an upsampling path of layers that increase spatial resolution, refining the segmentation output. Corresponding layers in the contracting and upsampling paths are linked to preserve spatial information that might be lost during the downsampling process, thus helping to retain fine-grained spatial information lost during downsampling. The HALtracks 2D and HALtracks 3D semantic segmentation approaches utilise both transmitted and reflected light images of fission-tracks in apatite or mica to identify fission-tracks, in this case to label each pixel in an image with a class: ‘track opening’ or ‘non-track opening’. The geometries and number of track openings are then determined using a conventional particle counting algorithm built into the FastTracks digital fission-track analytical software (Gleadow et al., 2009). Subsequent area thresholding using the built-in FastTracks tools then rules out spurious non-track features by excluding features whose area, circularity, and aspect ratio are too small or too large, and automatically identifies the presence and number of tracks whose openings overlap. 

HALtracks 2D and HALtracks 3D were trained, validated and tested using a very large training dataset of 6,526 image sets of 292,758 spontaneous fission-tracks in apatite collected over the last decade by the Melbourne Thermochronology Research Group. The training dataset includes apatites with a wide range of track densities (0 to 1.52 x 107 tracks/cm2) and mean Dpars (0.51 to 4.89 µm), reflective of the range in apatite fission-track characteristics found in nature. Due to the large size of the training and testing digital fission-track training datasets (~2.5 TB), these data are not included in this repo. Please contact the authors if you wish to utilise these datasets.

See Boone et al. (2025) for detailed descriptions of the CNN architectures, training regimes, and testing protocols. 

The HALtracks 2D and HALtracks 3D algorithms are saved as .onnx models. The .onnx file is an Open Neural Network Exchange (ONNX) formatted file, which is the current interoperability format for neural network models. These models can be loaded and used in other languages such as Java. Both automated fission-track identification algorithms are incorporated into the digital fission track analsyis software, FastTracks V4. 
